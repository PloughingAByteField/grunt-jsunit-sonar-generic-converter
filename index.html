<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Grunt-karma-sonar by mdasberg</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Grunt-karma-sonar</h1>
      <h2 class="project-tagline">Grunt plugin for integrating karma and protractor reports with sonar</h2>
      <a href="https://github.com/mdasberg/grunt-karma-sonar" class="btn">View on GitHub</a>
      <a href="https://github.com/mdasberg/grunt-karma-sonar/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mdasberg/grunt-karma-sonar/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="grunt-karma-sonar" class="anchor" href="#grunt-karma-sonar" aria-hidden="true"><span class="octicon octicon-link"></span></a>grunt-karma-sonar</h1>

<p><a href="https://travis-ci.org/mdasberg/grunt-karma-sonar"><img src="https://travis-ci.org/mdasberg/grunt-karma-sonar.svg?branch=master" alt="Build Status"></a> <a href="https://github.com/mdasberg/grunt-karma-sonar"><img src="https://img.shields.io/node/v/grunt-karma-sonar.svg" alt="npm version"></a> <a href="https://david-dm.org/mdasberg/grunt-karma-sonar"><img src="https://img.shields.io/david/mdasberg/grunt-karma-sonar.svg" alt="dependency Status"></a> <a href="https://david-dm.org/mdasberg/grunt-karma-sonar#info=devDependencies"><img src="https://img.shields.io/david/dev/mdasberg/grunt-karma-sonar.svg" alt="devDependency Status"></a> <a href="https://www.npmjs.com/package/grunt-karma-sonar"><img src="https://img.shields.io/npm/dm/grunt-karma-sonar.svg?style=flat-square" alt="npm downloads"></a></p>

<blockquote>
<p>Grunt plugin for integrating karma and protractor reports with sonar.</p>
</blockquote>

<p>Currently the following frameworks are supported for both unit and integration testing: </p>

<ul>
<li>jasmine / jasmine2 (the default)</li>
<li>cucumber</li>
</ul>

<p>To enable integration test result and coverage in Sonar, you need to install the following plugin <a href="https://github.com/nvnoorloos/sonar-javascript-integrationtests">sonar-javascript-integrationtests</a></p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>This plugin requires Grunt <code>~0.4.5</code></p>

<p>If you haven't used <a href="http://gruntjs.com/">Grunt</a> before, be sure to check out the <a href="http://gruntjs.com/getting-started">Getting Started</a> guide, as it explains how to create a <a href="http://gruntjs.com/sample-gruntfile">Gruntfile</a> as well as install and use Grunt plugins. Once you're familiar with that process, you may install this plugin with this command:</p>

<div class="highlight highlight-source-shell"><pre>npm install grunt-karma-sonar --save-dev</pre></div>

<p>Once the plugin has been installed, it may be enabled inside your Gruntfile with this line of JavaScript:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">grunt</span>.<span class="pl-en">loadNpmTasks</span>(<span class="pl-s"><span class="pl-pds">'</span>grunt-karma-sonar<span class="pl-pds">'</span></span>);</pre></div>

<h2>
<a id="the-karmasonar-task" class="anchor" href="#the-karmasonar-task" aria-hidden="true"><span class="octicon octicon-link"></span></a>The "karmaSonar" task</h2>

<h3>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h3>

<p>In your project's Gruntfile, add a section named <code>karmaSonar</code> to the data object passed into <code>grunt.initConfig()</code>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">grunt</span>.<span class="pl-en">initConfig</span>({
  karmaSonar<span class="pl-k">:</span> {
    options<span class="pl-k">:</span> {
      <span class="pl-c">// Task-specific options go here.</span>
    },
    your_target<span class="pl-k">:</span> {
      <span class="pl-c">// Target-specific file lists and/or options go here.</span>
    },
  },
})</pre></div>

<h3>
<a id="options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options</h3>

<h4>
<a id="optionsdynamicanalysis" class="anchor" href="#optionsdynamicanalysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.dynamicAnalysis</h4>

<p>Type: <code>String</code>
Default: 'reuseReports'</p>

<p>Should be the sonar.property dynamicAnalysis</p>

<h4>
<a id="optionssourceencoding" class="anchor" href="#optionssourceencoding" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.sourceEncoding</h4>

<p>Type: <code>String</code>
Default: 'UTF-8'</p>

<p>Should be the sonar.property sourceEncoding</p>

<h4>
<a id="optionslanguage" class="anchor" href="#optionslanguage" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.language</h4>

<p>Type: <code>String</code>
Default: 'js'</p>

<p>Should be the sonar.property language (Starting with SonarQube 4.2, multi-language projects are supported. To enable this, set the value to null)</p>

<h4>
<a id="optionsscmdisabled" class="anchor" href="#optionsscmdisabled" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.scmDisabled</h4>

<p>Type: <code>String</code>
Default: 'true'</p>

<p>Should be the sonar.property scmDisabled</p>

<h4>
<a id="optionsdefaultoutputdir" class="anchor" href="#optionsdefaultoutputdir" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.defaultOutputDir</h4>

<p>Type: <code>String</code>
Default: '.tmp/sonar/'</p>

<p>Should be the location where the karmaSonar plugin will put it's temporary files.</p>

<h4>
<a id="optionsexcludedproperties" class="anchor" href="#optionsexcludedproperties" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.excludedProperties</h4>

<p>Type: <code>Array</code>
Default: []</p>

<p>Should be a list of sonar properties to exclude</p>

<h4>
<a id="optionsinstancehosturl" class="anchor" href="#optionsinstancehosturl" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.hostUrl</h4>

<p>Type: <code>String</code>
Default: 'http://localhost:9000'</p>

<p>Should be the sonar.property host.url</p>

<h4>
<a id="optionsinstancejdbcurl" class="anchor" href="#optionsinstancejdbcurl" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.jdbcUrl</h4>

<p>Type: <code>String</code>
Default: 'jdbc:h2:tcp://localhost:9092/sonar'</p>

<p>Should be the sonar.property jdbc.url</p>

<h4>
<a id="optionsinstancejdbcusername" class="anchor" href="#optionsinstancejdbcusername" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.jdbcUsername</h4>

<p>Type: <code>String</code>
Default: 'sonar'</p>

<p>Should be the sonar.property jdbc.username</p>

<h4>
<a id="optionsinstancejdbcpassword" class="anchor" href="#optionsinstancejdbcpassword" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.jdbcPassword</h4>

<p>Type: <code>String</code>
Default: 'sonar'</p>

<p>Should be the sonar.property jdbc.password</p>

<h4>
<a id="optionsinstancelogin" class="anchor" href="#optionsinstancelogin" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.login</h4>

<p>Type: <code>String</code>
Default: 'admin'</p>

<p>Should be the sonar.property login</p>

<h4>
<a id="optionsinstancepassword" class="anchor" href="#optionsinstancepassword" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.password</h4>

<p>Type: <code>String</code>
Default: 'admin'</p>

<p>Should be the sonar.property password</p>

<h4>
<a id="optionsinstancerunnerproperties" class="anchor" href="#optionsinstancerunnerproperties" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.instance.runnerProperties</h4>

<p>Type: <code>Object</code></p>

<p>Should be the list of key(<code>sonar key</code>) value pairs.</p>

<div class="highlight highlight-source-js"><pre>runnerProperties<span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>sonar.links.homepage<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>https://github.com/mdasberg/grunt-karma-sonar<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>sonar.branch<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>master<span class="pl-pds">'</span></span>
}</pre></div>

<h4>
<a id="optionsdebug" class="anchor" href="#optionsdebug" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.debug</h4>

<p>Type: <code>Boolean</code>
Default: 'false'</p>

<p>If true sonar-runner debug logging will be turned on. </p>

<h4>
<a id="project" class="anchor" href="#project" aria-hidden="true"><span class="octicon octicon-link"></span></a>project</h4>

<p>Type: <code>Object</code>,
Mandatory: true</p>

<p>Should be the project information for sonar</p>

<h4>
<a id="projectkey" class="anchor" href="#projectkey" aria-hidden="true"><span class="octicon octicon-link"></span></a>project.key</h4>

<p>Type: <code>String</code>
Mandatory: true`</p>

<p>Should be the project key for sonar </p>

<h4>
<a id="projectname" class="anchor" href="#projectname" aria-hidden="true"><span class="octicon octicon-link"></span></a>project.name</h4>

<p>Type: <code>String</code>
Mandatory: true`</p>

<p>Should be the project name for sonar</p>

<h4>
<a id="projectversion" class="anchor" href="#projectversion" aria-hidden="true"><span class="octicon octicon-link"></span></a>project.version</h4>

<p>Type: <code>String</code></p>

<p>Should be the project version for sonar </p>

<h4>
<a id="paths" class="anchor" href="#paths" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths</h4>

<p>Type: <code>Array</code></p>

<p>Should be the paths that contain the code, tests and results</p>

<h4>
<a id="pathscwd" class="anchor" href="#pathscwd" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].cwd</h4>

<p>Type: <code>String</code>
Default: '.'</p>

<p>Should be the current working directory that contain the source, tests and results folders are located</p>

<h4>
<a id="pathssrc" class="anchor" href="#pathssrc" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].src</h4>

<p>Type: <code>String</code></p>

<p>Should be the directory containing the sources within the cwd.</p>

<h4>
<a id="pathstest" class="anchor" href="#pathstest" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].test</h4>

<p>Type: <code>String</code></p>

<p>Should be the directory containing the tests within the cwd.</p>

<h4>
<a id="pathsreports" class="anchor" href="#pathsreports" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].reports</h4>

<p>Type: <code>Object</code></p>

<p>Should be the object containing the reports.</p>

<h4>
<a id="pathsreportsunit" class="anchor" href="#pathsreportsunit" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].reports.unit</h4>

<p>Type: <code>String</code> or <code>Object</code> ie: {src: '...', framework: 'jasmine'} (Supported frameworks are: cucumber, jasmine/jasmine2(default))</p>

<p>Should be the location of the karma-junit-reporter report within the cwd.</p>

<h4>
<a id="pathsreportscoverage" class="anchor" href="#pathsreportscoverage" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].reports.coverage</h4>

<p>Type: <code>String</code></p>

<p>Should be the glob for the lcov.info files within the cwd.</p>

<h4>
<a id="pathsreportsitunit" class="anchor" href="#pathsreportsitunit" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].reports.itUnit</h4>

<p>Type: <code>String</code> or <code>Object</code> ie: {src: '...', framework: 'jasmine'} (Supported frameworks are: cucumber, jasmine/jasmine2(default))</p>

<p>Should be the location of the protractor report within the cwd.</p>

<h4>
<a id="pathsreportsitcoverage" class="anchor" href="#pathsreportsitcoverage" aria-hidden="true"><span class="octicon octicon-link"></span></a>paths[].reports.itCoverage</h4>

<p>Type: <code>String</code></p>

<p>Should be the glob for the integration test lcov.info files within the cwd.</p>

<h3>
<a id="usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage Examples</h3>

<h4>
<a id="default-options" class="anchor" href="#default-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Default Options</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">grunt</span>.<span class="pl-en">initConfig</span>({
  karmaSonar<span class="pl-k">:</span> {
    options<span class="pl-k">:</span> {

    },
    your_target<span class="pl-k">:</span> {
      project<span class="pl-k">:</span> {
        key<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>grunt-sonar<span class="pl-pds">'</span></span>,
        name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Grunt sonar plugin<span class="pl-pds">'</span></span>,
        version<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>0.2.13<span class="pl-pds">'</span></span>
      },
      paths<span class="pl-k">:</span> [
        {
          cwd<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the current working directory'</span>
          src<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the source directory within the cwd</span>
          test<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the test directory within the cwd</span>
          reports<span class="pl-k">:</span> {
              unit<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/result.xml<span class="pl-pds">'</span></span>, <span class="pl-c">// the result file within the cwd</span>
              coverage<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/**/lcov.info<span class="pl-pds">'</span></span>, <span class="pl-c">// the glob for lcov files'</span>
              itCoverage<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/**/lcov.info<span class="pl-pds">'</span></span> <span class="pl-c">// the glob for integration lcov files'</span>
          }
        },
        {
          cwd<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the current working directory'</span>
          src<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the source directory within the cwd</span>
          test<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>, <span class="pl-c">// the test directory within the cwd</span>
          reports<span class="pl-k">:</span> {
              unit<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/result.xml<span class="pl-pds">'</span></span>, <span class="pl-c">// the result file within the cwd</span>
              coverage<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/**/lcov.info<span class="pl-pds">'</span></span>, <span class="pl-c">// the glob for lcov files'</span>
              itCoverage<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../path/**/lcov.info<span class="pl-pds">'</span></span> <span class="pl-c">// the glob for integration lcov files'</span>
          }
      ],
      exclusions<span class="pl-k">:</span> []
    }
  }
})</pre></div>

<h4>
<a id="custom-options" class="anchor" href="#custom-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom Options</h4>

<p>In this example, custom options are used to do something else with whatever else. So if the <code>testing</code> file has the content <code>Testing</code> and the <code>123</code> file had the content <code>1 2 3</code>, the generated result in this case would be <code>Testing: 1 2 3 !!!</code></p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">grunt</span>.<span class="pl-en">initConfig</span>({
  karmaSonar<span class="pl-k">:</span> {
    options<span class="pl-k">:</span> {
      defaultOutputDir<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>.tmp/sonar/custom_options/<span class="pl-pds">'</span></span>,
      instance<span class="pl-k">:</span> {
        hostUrl <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http://localhost:20001<span class="pl-pds">'</span></span>,
        jdbcUrl <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>jdbc:h2:tcp://localhost:20003/sonar<span class="pl-pds">'</span></span>,
        login<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>admin<span class="pl-pds">'</span></span>,
        password<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>admin<span class="pl-pds">'</span></span>
      }
    },
    your_target<span class="pl-k">:</span> {
      project<span class="pl-k">:</span> {
        key<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>grunt-sonar<span class="pl-pds">'</span></span>,
        name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Grunt sonar plugin<span class="pl-pds">'</span></span>,
        version<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>0.2.13<span class="pl-pds">'</span></span>
      },
      paths<span class="pl-k">:</span> [...],
      exclusions<span class="pl-k">:</span> []
    }
  }
})</pre></div>

<h2>
<a id="deciding-where-to-get-sonar-runner-from" class="anchor" href="#deciding-where-to-get-sonar-runner-from" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deciding Where To Get Sonar-runner from</h2>

<p>By default, this package will download sonar-runner from <code>https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=org.codehaus.sonar.runner&amp;a=sonar-runner-dist&amp;v=LATEST&amp;p=zip</code>, 
but only when sonar-runner is not available on the path.</p>

<h5>
<a id="downloading-from-a-custom-url" class="anchor" href="#downloading-from-a-custom-url" aria-hidden="true"><span class="octicon octicon-link"></span></a>Downloading from a custom URL</h5>

<p>If for some reason sonatype is down, or the Great Firewall is blocking sonatype, you may need to use
a download mirror url. To set a mirror, set npm config property <code>sonarrunner_cdnurl</code>.
Default is ``.</p>

<div class="highlight highlight-source-shell"><pre>npm install grunt-karma-sonar --sonarrunner_cdnurl=http://some-mirror.org/path/to/downloads</pre></div>

<p>Or add property into your <code>.npmrc</code> file (<a href="https://www.npmjs.org/doc/files/npmrc.html">https://www.npmjs.org/doc/files/npmrc.html</a>)</p>

<pre><code>sonarrunner_cdnurl=http://some-mirror.org/path/to/downloads
</code></pre>

<p>Another option is to use PATH variable <code>SONARRUNNER_CDNURL</code>.</p>

<div class="highlight highlight-source-shell"><pre>SONARRUNNER_CDNURL=http://some-mirror.org/path/to/downloads npm install grunt-karma-sonar</pre></div>

<p>Note: It will try to find <code>sonar-runner-dist.zip</code> in the cdn url.</p>

<h5>
<a id="downloading-from-a-custom-dir" class="anchor" href="#downloading-from-a-custom-dir" aria-hidden="true"><span class="octicon octicon-link"></span></a>Downloading from a custom Dir</h5>

<p>If for some reason sonatype is down, or the Great Firewall is blocking sonatype, you may need to use
a download mirror directory. To set a mirror, set npm config property <code>sonarrunner_cdndir</code>.
Default is ``.</p>

<div class="highlight highlight-source-shell"><pre>npm install grunt-karma-sonar --sonarrunner_cdndir=/some/path/downloads</pre></div>

<p>Or add property into your <code>.npmrc</code> file (<a href="https://www.npmjs.org/doc/files/npmrc.html">https://www.npmjs.org/doc/files/npmrc.html</a>)</p>

<pre><code>sonarrunner_cdndir=/some/path/downloads
</code></pre>

<p>Another option is to use PATH variable <code>SONARRUNNER_CDNDIR</code>.</p>

<div class="highlight highlight-source-shell"><pre>SONARRUNNER_CDNDIR=/some/path/downloads npm install grunt-karma-sonar</pre></div>

<p>Note: It can be the case that there are multiple versions available at the download mirror. 
If this is the case the latest version will be used.</p>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<p>In lieu of a formal styleguide, take care to maintain the existing coding style. Add unit tests for any new or changed functionality. Lint and test your code using <a href="http://gruntjs.com/">Grunt</a>.</p>

<h2>
<a id="release-history" class="anchor" href="#release-history" aria-hidden="true"><span class="octicon octicon-link"></span></a>Release History</h2>

<p><em>(Nothing yet)</em></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mdasberg/grunt-karma-sonar">Grunt-karma-sonar</a> is maintained by <a href="https://github.com/mdasberg">mdasberg</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
